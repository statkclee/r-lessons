<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="pandoc">
    <title>Software Carpentry: 데이터 제품</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="css/swc.css" />
    <link rel="alternate" type="application/rss+xml" title="Software Carpentry Blog" href="http://software-carpentry.org/feed.xml"/>
    <meta charset="UTF-8" />
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body class="lesson">
    <div class="container card">
      <div class="banner">
        <a href="http://software-carpentry.org" title="Software Carpentry">
          <img alt="Software Carpentry banner" src="img/software-carpentry-banner.png" />
        </a>
      </div>
      <div class="row">
        <div class="col-md-10 col-md-offset-1">
          <h1 class="title">데이터 제품</h1>
          <h2 class="subtitle">Data Product</h2>
<div id="학습-목표" class="objectives panel panel-warning">
<div class="panel-heading">
<h2><span class="glyphicon glyphicon-certificate"></span>학습 목표</h2>
</div>
<div class="panel-body">
<ul>
<li>데이터 과학자 역량</li>
<li>데이터 제품 개발</li>
</ul>
</div>
</div>
<h3 id="데이터-과학자-및-팀-역량">데이터 과학자 및 팀 역량</h3>
<p>데이터 과학자가 갖추어야할 역량은 컴퓨터 과학, 수학/통계학, 특정 분야 전문지식 외에 기계학습, 소통 및 발표기술, 데이터 시각화등 다양한 역량이 필요하며, 콘웨이(Drew Conway)가 데이터과학 벤다이어그램으로 데이터과학 역량을 시각화하였다.</p>
<ul>
<li>컴퓨터 과학 (Computer science)</li>
<li>수학 (Math)</li>
<li>통계학 (Statistics)</li>
<li>기계 학습 (Machine learning)</li>
<li>특정 분야 업무지식 (Domain expertise)</li>
<li>소통 및 발표 기술 (Communication and presentation skills)</li>
<li>데이터 시각화 (Data visualization)</li>
</ul>
<div class="figure">
<img src="img/conway-diagram.svg" title="Drew Conway&#39;s Diagram" alt="콘웨이(Drew Conway) 데이터 과학 벤다이어그램" /><p class="caption">콘웨이(Drew Conway) 데이터 과학 벤다이어그램</p>
</div>
<h4 id="데이터-과학팀-역량">데이터 과학팀 역량</h4>
<p>훌륭한 데이터 과학 제품을 개발하고, 마케팅/판매, 운영, 소통을 위한 종합적인 역량이 필요하다. 데이터 과학 제품을 개발하기 위해서 개발팀을 구성하는데 컴퓨터 공학 전문가, 수학/통계학 전문가, 그래픽 디자이너, 특정분야 전문가 등 다양한 사람이 필요하다. <a href="http://www.oreilly.com/data/free/files/analyzing-the-analyzers.pdf">Harlan Harris, Sean Murphy, Marck Vaisman</a>은 각 개인의 역량과 데이터 과학팀 역량을 시각화하였다.</p>
<div class="figure">
<img src="img/data-scientist.png" title="Data Scientists and Team" alt="데이터 과학팀 역량도" /><p class="caption">데이터 과학팀 역량도</p>
</div>
<p>참고자료: Harlan Harris, Sean Murphy, Marck Vaisman, “Analyzing the Analyzers: An Introspective Survey of Data Scientists and Their Work”, O'Reilly, June 2013</p>
<h3 id="데이터-제품-개발-방법론">데이터 제품 개발 방법론</h3>
<p>제조업에서 목표로 하는 제품를 개발하는 방법론과 동일한 방법론을 <strong>데이터 제품(Data Product)</strong>에 적용한다. 데이터를 가지고 모델을 만든 후에 모델에 대해서 다양한 모의시험을 실시하고 제어변수를 통해 최적화를 진행한 후에 행동을 취한다.</p>
<table>
<tr>
<th>
개발방법 이론
</th>
<th>
데이터 과학 구현
</th>
</tr>
<tr>
<td>
<ol style="list-style-type: decimal">
<li>목표 설정한다.
</td>
<td>
<ol style="list-style-type: decimal">
<li>데이터 제품 계획 수립
</td>
</tr>
<tr>
<td>
<ol start="2" style="list-style-type: decimal">
<li>제어변수를 명확히 한다.
</td>
<td>
<ol start="2" style="list-style-type: decimal">
<li>제어가능한 변수 판별
</td>
</tr>
<tr>
<td>
<ol start="3" style="list-style-type: decimal">
<li>자료를 수집한다.
</td>
<td>
<ol start="3" style="list-style-type: decimal">
<li>다양한 내외부 데이터 (Open API, HTML등)를 R 로 가져온다.
</td>
</tr>
<tr>
<td>
<ol start="4" style="list-style-type: decimal">
<li>예측 모형을 생성한다.
</td>
<td>
<ol start="4" style="list-style-type: decimal">
<li>통계모델 및 머신러닝을 활용하여 모델을 생성한다.
</td>
</tr>
<tr>
<td>
<ol start="5" style="list-style-type: decimal">
<li>모의시험을 실행한다.
</td>
<td>
<ol start="5" style="list-style-type: decimal">
<li>Bootstrapping 모의시험을 수행한다.
</td>
</tr>
<tr>
<td>
<ol start="6" style="list-style-type: decimal">
<li>최적화를 한다.
</td>
<td>
<ol start="6" style="list-style-type: decimal">
<li>모형 정교화 및 데이터제품 최적화
</td>
</tr>
<tr>
<td>
<ol start="7" style="list-style-type: decimal">
<li>행동(Action)을 취한다.
</td>
<td>
<ol start="7" style="list-style-type: decimal">
<li>생성된 모델을 Shiny등을 통해 클라우드로 배포한다.
</td>
</tr>
</table></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol>
<div class="figure">
<img src="img/web-app-product.png" title="Web Application Products" alt="클라우드 배포 웹어플리케이션 제품" /><p class="caption">클라우드 배포 웹어플리케이션 제품</p>
</div>
<div id="the-agile-manifesto" class="callout panel panel-info">
<div class="panel-heading">
<h2><span class="glyphicon glyphicon-pushpin"></span>The Agile Manifesto</h2>
</div>
<div class="panel-body">
<p><strong>Individuals and interactions</strong> over processes and tools<br /><strong>Working software</strong> over comprehensive documentation<br /><strong>Customer collaboration</strong> over contract negotiation<br /><strong>Responding to change</strong> over following a plan</p>
<p>참고: Jurney, Russell. Agile Data Science: Building Data Analytics Applications with Hadoop. &quot; O'Reilly Media, Inc.&quot;, 2013.</p>
</div>
</div>
<div id="제품-디자인이란" class="callout panel panel-info">
<div class="panel-heading">
<h2><span class="glyphicon glyphicon-pushpin"></span>제품 디자인이란?</h2>
</div>
<div class="panel-body">
<p>In the documentary The Lost Interview, Steve Jobs said this about design: “Designing a product is keeping five thousand things in your brain and fitting them all together in new and different ways to get what you want. And every day you discover something new that is a new problem or a new opportunity to fit these things together a little differently. And it’s that process that is the magic.”</p>
</div>
</div>
<h3 id="데이터-제품-개발-및-운영-프로세스">데이터 제품 개발 및 운영 프로세스</h3>
<p>데이터 제품 개발 순서는 2단계 (Two-Phase) 모형으로 첫번째가 데이터 제품 개발(Development), 두번째가 데이터 제품 운영(Operations)단계로 나눌 수 있다.</p>
<ol style="list-style-type: decimal">
<li>제품 개발 단계
<ul>
<li>자료 수집 (Collecting data)</li>
<li>자료 저장 (Storing data)</li>
<li>자료 처리 (Processing data)</li>
</ul></li>
<li>제품 운영단계
<ul>
<li>자료 배포 (Publishing data)</li>
<li>자료 상품화 (Decorating data)</li>
</ul></li>
</ol>
<p>이벤트는 다양한 형식으로 생성되는데 센서, 금융 거래, 응용프로그램 사용자 이력, 서버 로그 등이 포함된다. 이벤트를 통해서 생성된 원자료는 수집기(Collector)를 통해서 대용량 저장소, 실시간 스트리밍 데이터 큐로 채집된다. 대용량 저장소는 물리적 저장 위치로 아마죤 S3, 소프트웨어적으로는 하둡 분산 파일시스템(Hadoop Distributed FileSystem, HDFS)에 담겨진다. 하둡이 없었다면 오늘날 빅데이터는 아마 존재하기 어려웠을 것이다. 하둡에 담겨진 대용량 데이터를 처리한 다음 정제된 형태로 분산 문서 저장소에 담겨진다. MongoDB같은 NoSQL시스템을 사용해서 웹응용프로그램이나 다른 서버가 사용할 수 있는 형태로 보관되어 서비스를 제공한다. 응용서버는 Python/Flask나 Ruby/Sinatra 같은 경량 웹프레임워크를 사용해서 웹브라우져 요청이 있을 때 서비스를 제공한다.</p>
<div class="figure">
<img src="img/development-process.svg" title="Data Product DevOps" alt="데이터 제품 개발 및 운영 프로세스" /><p class="caption">데이터 제품 개발 및 운영 프로세스</p>
</div>
<h3 id="r-소프트웨어">R 소프트웨어</h3>
<p><code>S</code>는 1976년부터 벨연구소에서 자료분석을 위해서 인터랙트비 환경으로 개발된 언어로 1988년 <code>S2</code>로 RA Becker, JM Chambers, A Wilks에 의해 발전되었으며, JM Chambers, TJ Hastie에 의해서 1992년 <code>S3</code>로, JM Chambers에 의해 1998년 <code>S4</code>로 진화되었다. AT&amp;T/Lucent는 시애틀 소재 Insightful Corporation에 &quot;S-plus&quot;라는 제품으로 판매될 수 있는 독점 라이센스를 주었다. <code>R</code>은 오클랜드 대학의 Ross Ihaka와 Robert Gentleman에 의해서 1990년부터 개발되다가 1997년 15명으로 구성된 국제적인 &quot;R-Core&quot;팀으로 개발되어오고 있다.</p>
<h4 id="r-데이터-제품-툴-체인tool-chain">R 데이터 제품 툴 체인(Tool Chain)</h4>
<p>데이터 제품을 만들기 위해서 세가지 툴을 준비해야 한다.</p>
<ol style="list-style-type: decimal">
<li><a href="http://cran.r-project.org/">R</a> : 데이터 분석 엔진이며 자료분석 DSL로 생산성이 매우 높다.<br /></li>
<li><a href="http://www.rstudio.com/">RStudio</a> : <code>R</code>기반 통합개발환경(IDE, Integrated Development Environment)<br /></li>
<li><a href="http://shiny.rstudio.com/">Shiny</a> : <code>R</code>과 <code>RStudio</code>에 기반한 인터랙티브 웹응용프로그램 개발 및 운영 플랫폼.</li>
</ol>
<h4 id="기본-r-쉘-명령어">기본 R 쉘 명령어</h4>
<p>현재 작업공간을 확인하는 명령어는 getwd() 이며, 새로운 작업공간을 설정하는 명령어는 setwd() 이다. 현재 작업공간이 “C:” 디렉토리인데 setwd() 명령어를 통해서 새로운 작업 공간으로 변경을 했다. 이것이 필요한 이유는 R은 기본적으로 자료처리 언어이기 때문에 데이터의 사전 위치를 파악하여 효율적으로 작업할 수 있다.</p>
<pre class="output"><code>&gt; getwd()
[1] &quot;C:/&quot;
&gt; setwd(&quot;D:/01. Work/09. Data_Products&quot;)
&gt; getwd()
[1] &quot;D:/01. Work/09. Data_Products&quot;
&gt; system(&quot;ls&quot;) # 윈도우에서는 shell(&quot;dir&quot;), dir()</code></pre>
<h4 id="r-패키지package-설치">R 패키지(package) 설치</h4>
<p>R의 강점은 다양한 패키지를 지원하므로 새로이 뭔가 필요한 것을 자체 개발하는 것보다 우선 다른 사람들이 해논 것을 참조하고 이를 확대하여 가는 것을 권장한다. R 패키지를 설치하는 방법에 대해서 알아보자. R Studio 상에서 R 패키지를 설치하는 방법은 메뉴 상단의 Tools &gt; Install Packages… 를 클리하면 “Install Packages” 팝업 메뉴가 나오고 원하는 패키지를 설치하면 된다. rpart는 의사결정나무모델 (Decision Tree) 을 구현할 때 자주 사용되는 패키지로 별도로 개발할 필요없이 기존의 개발 검증된 rpart 패키지를 사용하는 것도 좋겠다. GUI를 통해서 일일이 설치하는 것도 좋지만, install.packages를 통한 명령어를 통해서도 설치가 동일하게 가능하다.</p>
<pre class="output"><code>&gt; install.packages(&quot;rpart&quot;)
trying URL &#39;http://cran.rstudio.com/bin/windows/contrib/3.1/rpart_4.1-8.zip&#39;
Content type &#39;application/zip&#39; length 917885 bytes (896 Kb)
opened URL downloaded 896 Kb

package ‘rpart’ successfully unpacked and MD5 sums checked
The downloaded binary packages are in
    C:\Users\Administrator\AppData\Local\Temp\Rtmp4Ce7l1\downloaded_packages</code></pre>
<h4 id="r-맛보기">R 맛보기</h4>
<p>R이 설치되고, 필요한 패키지가 준비되면 분석에 사용할 데이터를 작업 메모리상에 올려야 한다. 분석 데이터를 R 작업공간에 준비하는 방법은 어려가지가 있다. Web URL을 활용한 웹 데이터를 가져오거나, <code>read.table</code>을 이용한 로컬 디스크 상의 데이터를 메모리로 불러올 수 있다.</p>
<pre class="sourceCode python"><code class="sourceCode python">&gt; abalone &lt;- read.csv(url(<span class="st">&quot;http://archive.ics.uci.edu/ml/machine-learning-databases/abalone/abalone.data&quot;</span>), header=F)
&gt; names(abalone) &lt;- c(<span class="st">&quot;Sex&quot;</span>,<span class="st">&quot;Length&quot;</span>,<span class="st">&quot;Diameter&quot;</span>,<span class="st">&quot;Height&quot;</span>,<span class="st">&quot;Whole weight&quot;</span>,<span class="st">&quot;Shucked weight&quot;</span>,<span class="st">&quot;Viscera weight&quot;</span>,<span class="st">&quot;Shell weight&quot;</span>,<span class="st">&quot;Rings&quot;</span>)
&gt; head(abalone)</code></pre>
<pre class="out"><code>  Sex Length Diameter Height Whole weight Shucked weight
1   M  0.455    0.365  0.095       0.5140         0.2245
2   M  0.350    0.265  0.090       0.2255         0.0995
3   F  0.530    0.420  0.135       0.6770         0.2565
4   M  0.440    0.365  0.125       0.5160         0.2155
5   I  0.330    0.255  0.080       0.2050         0.0895
6   I  0.425    0.300  0.095       0.3515         0.1410
  Viscera weight Shell weight Rings
1         0.1010        0.150    15
2         0.0485        0.070     7
3         0.1415        0.210     9
4         0.1140        0.155    10
5         0.0395        0.055     7
6         0.0775        0.120     8</code></pre>
<p>분석을 진행하기 위해서 간단한 R 스크립트를 작성하여 보자. 메뉴상단의 File &gt; New File &gt; R Script 혹은 “CTRL+SHIFT+N” 단축키를 사용하여 데이터 분석 결과를 스크립트로 작성하여 저장할 수 있다. 분석이 완료된 스크립트는 SimpleR.R로 저장한다.</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="co"># Simple Analysis Sctript</span>
abalone &lt;- read.csv(<span class="st">&quot;abalone.csv&quot;</span>)
table(abalone$Sex)
plot(Length ~ Sex, data=abalone)</code></pre>
<pre class="out"><code>&gt; # Simple Analysis Sctript
&gt; abalone &lt;- read.csv(&quot;abalone.csv&quot;)
&gt; table(abalone$Sex)
   F    I    M 
1307 1342 1528 
&gt; plot(Length ~ Sex, data=abalone)</code></pre>
<p>자료 분석의 결과는 코드, 데이터, 그래프, 테이블로 나타나게 되며 이를 하나의 문서로 각각 정리하는 것은 매우 수고스러운 일이며 기본적으로 기계나 컴퓨터가 해야되는 일중의 하나이다. 이를 위해서 RStudio의 Notebook 기능을 사용한다. 먼저 R Studio의 Notebook 도 knitr 패키지와 Rmarkdown 같은 패키지를 기반으로 하지만 knitr 패키지를 설치하면 모든 의존성을 자동으로 해결해 준다. knitr 패키지를 설치한 후에 메뉴상단의 File &gt; Compile Notebook… 을 클릭하면 팝업메뉴가 뜨며 제목과 저자를 표시하면 코드, 데이터, 그래프, 테이블 등 정리된 결과를 HTML 파일로 얻을 수 있다.</p>
<pre class="sourceCode python"><code class="sourceCode python">install.packages(<span class="st">&quot;knitr&quot;</span>)</code></pre>
<p>R 코드, 그림, 테이블, 텍스트와 함께 하나의 작업파일로 데이터 제품을 만들 수 있다. Notebook, Markdown, HTML, LaTex 등 총 4가지 방법이 있으나 RStudio를 사용할 경우 Built-in 된 Notebook을 사용하는 것도 좋은 방법이며, Markdwon, LaTex, HTML등 친숙한 방법을 사용할 수도 있다.</p>
<table>
<tr>
<th>
Markup 시스템
</th>
<th>
입력파일(Input)
</th>
<th>
리포트파일(Output)
</th>
</tr>
<tr>
<td>
Notebook
</td>
.R
<td>
</td>
<td>
.html (.md 경유)
</td>
</tr>
<tr>
<td>
Markdown
</td>
.Rmd
<td>
</td>
<td>
.html (.md 경유)
</td>
</tr>
<tr>
<td>
HTML
</td>
<td>
.Rhtml
</td>
<td>
.html
</td>
</tr>
<tr>
<td>
LaTeX
</td>
<td>
.Rnw
</td>
<td>
.pdf (.tex 경유)
</td>
</tr>
</table>
<p>RStudio_RMarkdown 을 이용하여 작업파일을 만든 후에 “knit HTML” 버튼을 누루면 HTML 파일을 바로 얻을 수 있다.</p>
<p>어느 소프트웨어도 마찬가지지만 사용하다보면 오류가 발생하고 이를 확인해야 할 때가 있다. <code>RStudio</code>의 경우 “Help&gt;Diagnostics&gt;Show log files” 를 통해서 확인가능하다. <code>R</code>과 <code>Rstudio</code> 관련 도움말은 google 검색이나, <a href="http://stackexchange.com/">stack exchange</a>를 통해 얻을 수 있다. 작업을 하다면 콘솔화면을 깨끗이하고 다시 시작하고 싶은 경우가 있다. 윈도나 도스의 경우 <code>cls</code> 명령어가 있는데 R에는 딱히 그런 명령어가 없다. 이런 경우 사용자 정의 함수를 하나 만들어서 실행할 수 있다.</p>
<pre class="sourceCode python"><code class="sourceCode python">&gt; cls &lt;- function() cat(rep(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dv">50</span>))
&gt; cls()</code></pre>
<p>하지만, 매번 R을 실행할 때마다 반복적으로 해야되기 때문에 R이 시작될 때 자동으로 설정을 하는 방법은 초기 실행 환경파일에 이를 적용하는 것이다. C:Files-3.1.0파일을 텍스트 편집기로 열어 하단에 <code>cls</code> 함수를 적어두고 저장한다. <code>혹은 CTRL+L</code> 키를 눌러 화면을 깨끗이하며 커서를 맨 위 상단으로 이동한다.</p>
<pre class="sourceCode python"><code class="sourceCode python">….
local({
    br &lt;- Sys.getenv(<span class="st">&quot;R_BROWSER&quot;</span>, NA_character_)
    <span class="kw">if</span>(!is.na(br)) options(browser = br)
    tests_startup &lt;- Sys.getenv(<span class="st">&quot;R_TESTS&quot;</span>)
    <span class="kw">if</span>(nzchar(tests_startup)) source(tests_startup)
})

<span class="co"># User Defined Functions</span>
cls &lt;- function() cat(rep(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dv">50</span>))</code></pre>
<h4 id="r-데이터-관리-data-manipulation">R 데이터 관리 (Data Manipulation)</h4>
<h5 id="모드mode와-클래스class">모드(mode)와 클래스(class)</h5>
<p>모드 함수는 객체의 모드를 리턴하고, 클래스 함수는 클래스를 리턴한다. 가장 흔하게 만나는 객체 모드는 숫자, 문자, 로직 모드다. 때때로 리스트와 데이터프레임과 같이 하나의 객체안에 여러 모드를 포함하기도 한다. 범주형 자료를 R에 저장하기 위해서 요인(Factor) 클래스를 사용하며 요인 클래스를 사용하여 자료를 저장할 경우 저장공간을 절약할 수 있다. 요인은 내부적으로 숫자(value)로 저장을 하고 레이블(value label)을 사용하여 표시를 하여 저장공간을 절약한다. 날짜와 시간도 중요한 데이터자료형니다. 리스트(List)는 데이터를 저장하는 유연하며 강력한 방법으로 sapply 함수와 함께 가장 빈번하게 사용되는 데이터 타입니다. 리스트형 자료 mylist를 세가지 숫자형, 문자형, 팩터형 세가지 데이터 형을 포함하게 작성하였다. sapply 함수를 이용하여 mode와 class 인자를 줌으로써, 각각의 데이터 형의 모드와 클래스를 확인할 수 있다.</p>
<pre class="sourceCode python"><code class="sourceCode python">&gt; mylist = <span class="dt">list</span>(a=c(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),b=c(<span class="st">&quot;cat&quot;</span>,<span class="st">&quot;dog&quot;</span>,<span class="st">&quot;duck&quot;</span>), d=factor(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;a&quot;</span>))
&gt; sapply(mylist,mode)
          a           b           d 
  <span class="co">&quot;numeric&quot;</span> <span class="st">&quot;character&quot;</span>   <span class="st">&quot;numeric&quot;</span> 
&gt; sapply(mylist,<span class="kw">class</span>)
          a           b           d 
  <span class="co">&quot;numeric&quot;</span> <span class="st">&quot;character&quot;</span>    <span class="st">&quot;factor&quot;</span> 
&gt; factor2 &lt;- factor(c(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>),labels=letters[<span class="dv">1</span>:<span class="dv">9</span>])
&gt; factor2
[<span class="dv">1</span>] a b c d e f g h i
Levels: a b c d e f g h i
&gt; levels(factor2)
[<span class="dv">1</span>] <span class="st">&quot;a&quot;</span> <span class="st">&quot;b&quot;</span> <span class="st">&quot;c&quot;</span> <span class="st">&quot;d&quot;</span> <span class="st">&quot;e&quot;</span> <span class="st">&quot;f&quot;</span> <span class="st">&quot;g&quot;</span> <span class="st">&quot;h&quot;</span> <span class="st">&quot;i&quot;</span>
&gt; labels(factor2)
[<span class="dv">1</span>] <span class="st">&quot;1&quot;</span> <span class="st">&quot;2&quot;</span> <span class="st">&quot;3&quot;</span> <span class="st">&quot;4&quot;</span> <span class="st">&quot;5&quot;</span> <span class="st">&quot;6&quot;</span> <span class="st">&quot;7&quot;</span> <span class="st">&quot;8&quot;</span> <span class="st">&quot;9&quot;</span></code></pre>
<h5 id="정의된-데이터-형식에-맞게-데이터-저장">정의된 데이터 형식에 맞게 데이터 저장</h5>
<p>가장 간단하게 자료를 저장할 수 있는 벡터 <code>c</code> 함수(concatenate or combine)로 시작해 봅시다. 1,2,5,10을 벡터 함수 <code>c</code>로 합쳐서 mode 함수를 확인하니 숫자형이 된다. 숫자가 문자가 합쳐진 y는 문자 자료 형식이 됩니다. 숫자와 논리 자료형이 합쳐진 경우는 숫자가 됩니다. 벡터를 합쳐서 all 과 같이 활용도 가능하며 당연히 문자 자료형이 된다.</p>
<pre class="sourceCode python"><code class="sourceCode python">&gt; x = c(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>)
&gt; x
[<span class="dv">1</span>]  <span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">5</span> <span class="dv">10</span>
&gt; mode(x)
[<span class="dv">1</span>] <span class="st">&quot;numeric&quot;</span>
&gt; y = c(<span class="dv">1</span>,<span class="dv">2</span>,<span class="st">&quot;cat&quot;</span>,<span class="dv">3</span>)
&gt; y
[<span class="dv">1</span>] <span class="st">&quot;1&quot;</span>   <span class="st">&quot;2&quot;</span>   <span class="st">&quot;cat&quot;</span> <span class="st">&quot;3&quot;</span>  
&gt; mode(y)
[<span class="dv">1</span>] <span class="st">&quot;character&quot;</span>
&gt; z = c(<span class="dv">5</span>,TRUE,<span class="dv">3</span>,<span class="dv">7</span>)
&gt; z
[<span class="dv">1</span>] <span class="dv">5</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">7</span>
&gt; mode(z)
[<span class="dv">1</span>] <span class="st">&quot;numeric&quot;</span>
&gt; <span class="dt">all</span> = c(x,y,z)
&gt; <span class="dt">all</span>
 [<span class="dv">1</span>] <span class="st">&quot;1&quot;</span>   <span class="st">&quot;2&quot;</span>   <span class="st">&quot;5&quot;</span>   <span class="st">&quot;10&quot;</span>  <span class="st">&quot;1&quot;</span>   <span class="st">&quot;2&quot;</span>   <span class="st">&quot;cat&quot;</span> <span class="st">&quot;3&quot;</span>   <span class="st">&quot;5&quot;</span>   <span class="st">&quot;1&quot;</span>  <span class="st">&quot;3&quot;</span>   <span class="st">&quot;7&quot;</span>
&gt; mode(<span class="dt">all</span>)
[<span class="dv">1</span>] <span class="st">&quot;character&quot;</span></code></pre>
<p>R은 6가지 기본 벡터 자료 저장 형식을 가지고 있다. 이와는 다른 행렬(matrix), 데이터프레임(data.frame), 리스트(list)가 있다.</p>
<table>
<tr>
<th>
자료형(Type)
</th>
<th>
모드(Mode)
</th>
<th>
저장모드(Storage Mode)
</th>
</tr>
<tr>
<td>
logical
</td>
<td>
logical
</td>
<td>
logical
</td>
</tr>
<tr>
<td>
integer
</td>
<td>
numeric
</td>
<td>
integer
</td>
</tr>
<tr>
<td>
double
</td>
<td>
numeric
</td>
<td>
double
</td>
</tr>
<tr>
<td>
complex
</td>
<td>
complex
</td>
<td>
complex
</td>
</tr>
<tr>
<td>
character
</td>
<td>
character
</td>
<td>
character
</td>
</tr>
<tr>
<td>
raw
</td>
<td>
raw
</td>
<td>
raw
</td>
</tr>
</table>
<p>자료분석을 위해서 자료를 데이터셋의 형태로 구성을 해야한다. 데이터셋이 중요한 이유는 자료를 분석하기 위해서 다양한 형태의 개별 자료를 통합적으로 분석하기 위해서다. 이를 위해서 리스트 자료구조로 일단 모으게 된다. 예를 들어 개인 신용분석을 위해서는 개인의 소득, 부채, 성별, 학력 등등의 숫자형, 문자형, 요소(Factor)형 등의 자료를 데이터셋에 담아야 한다. 특히 변수와-관측값 (Variable-Observation) 형식의 자료를 분석하기 위해서는 데이터프레임(<code>data.frame</code>)을 자주 사용한다. 데이터프레임은 모든 변수에 대해서 관측값이 같은 길이를 갖도록 만들어 놓은 것이다.</p>
<div class="figure">
<img src="img/list-dataframe.png" title="Comparison of list and data.frame" alt="리스트와 데이터프레임" /><p class="caption">리스트와 데이터프레임</p>
</div>
<h5 id="데이터-형식-테스트">데이터 형식 테스트</h5>
<p>각각의 데이터 형식에 맞는지를 다양한 테스트 함수를 이용하여 데이터 형식을 확인할 수 있다.</p>
<ul>
<li>is.list: 리스트 형식인 확인</li>
<li>is.factor: 팩터 형식인지 확인</li>
<li>is.numeric: 숫자형인지 확인</li>
<li>is.data.frame: 데이터 프레임형인지 확인</li>
<li>is.character: 문자형인지 확인</li>
</ul>
<h5 id="r-객체의-구조-파악">R 객체의 구조 파악</h5>
<p>간단한 자료는 데이터 형식을 확인할 수 있는 1~2줄 정도의 간단한 스크립트와 명령어를 통해서 확인이 가능하지만 복잡한 데이터의 구조를 파악하기 위해서는 summary 함수와 str 함수를 통해서 확인해야 한다.</p>
<pre class="sourceCode python"><code class="sourceCode python">&gt; mylist = <span class="dt">list</span>(a=c(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),b=c(<span class="st">&quot;cat&quot;</span>,<span class="st">&quot;dog&quot;</span>,<span class="st">&quot;duck&quot;</span>),d=factor(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;a&quot;</span>))
&gt; summary(mylist)
  Length Class  Mode     
a <span class="dv">3</span>      -none- numeric  
b <span class="dv">3</span>      -none- character
d <span class="dv">1</span>      factor numeric  
&gt; <span class="dt">str</span>(mylist)
List of <span class="dv">3</span>
 $ a: num [<span class="dv">1</span>:<span class="dv">3</span>] <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>
 $ b: <span class="dt">chr</span> [<span class="dv">1</span>:<span class="dv">3</span>] <span class="st">&quot;cat&quot;</span> <span class="st">&quot;dog&quot;</span> <span class="st">&quot;duck&quot;</span>
 $ d: Factor w/ <span class="dv">1</span> level <span class="st">&quot;a&quot;</span>: NA</code></pre>
<h5 id="r-코딩-규칙">R 코딩 규칙</h5>
<p>R 코드를 가독성이 좋으며 이해하기 쉽게 일관되게 작성하는 것이 중요하다. 코딩 규칙에 대한 자세한 사항은 <a href="http://journal.r-project.org/archive/2012-2/RJournal_2012-2_Baaaath.pdf">The State of Naming Conventions in R</a> 참조한다.</p>
<ul>
<li><a href="http://wiki.fhcrc.org/bioc/Coding_Standards">Bioconductor’s coding standards</a></li>
<li><a href="http://stat405.had.co.nz/r-style.html">Hadley Wickham’s style guide</a></li>
<li><a href="http://google-styleguide.googlecode.com/svn/trunk/google-r-style.html">Google’s R style guide</a></li>
<li><a href="http://csgillespie.wordpress.com/2010/11/23/r-style-guide/">Colin Gillespie’s R style guide</a></li>
</ul>
<h5 id="데이터-정제-data-manipulation">데이터 정제 (Data Manipulation)</h5>
<p><strong>plyr</strong>: split-apply-combine Strategy</p>
<ol style="list-style-type: decimal">
<li>Split the iris dataset into three parts.<br /></li>
<li>Remove the species name variable from the data.<br /></li>
<li>Calculate the mean of each variable for the three different parts separately.<br /></li>
<li>Combine the output into a single data frame.</li>
</ol>
<table>
<tr>
<th>
R
</th>
<th>
구글
</th>
</tr>
<tr>
<td>
split
</td>
<td>
Map
</td>
</tr>
<tr>
<td>
apply
</td>
<td>
Map
</td>
</tr>
<tr>
<td>
combine
</td>
<td>
Reduce
</td>
</tr>
</table>
<p>출처: Hadley Wickham, &quot;The Split-Apply-Combine Strategy for Data Analysis&quot; Journal of Statistical Software April 2011, Volume 40, Issue 1, <a href="http://www.jstatsoft.org/v40/i01/paper" class="uri">http://www.jstatsoft.org/v40/i01/paper</a></p>
<p><strong>전통적 방법</strong></p>
<pre class="sourceCode python"><code class="sourceCode python">&gt; <span class="co"># notice that during split step a negative 5 is used within the  </span>
&gt; <span class="co"># code, this negative 5 has been used to discard fifth column of t</span>
&gt; <span class="co"># iris data that contains &quot;species&quot; information and we do not need</span>
&gt; <span class="co"># that column to calculate mean.</span>
&gt; iris.<span class="dt">set</span> &lt;- iris[iris$Species==<span class="st">&quot;setosa&quot;</span>,-<span class="dv">5</span>]
&gt; iris.versi &lt;- iris[iris$Species==<span class="st">&quot;versicolor&quot;</span>,-<span class="dv">5</span>]
&gt; iris.virg &lt;- iris[iris$Species==<span class="st">&quot;virginica&quot;</span>,-<span class="dv">5</span>]
&gt; <span class="co"># calculating mean for each piece (The apply step)</span>
&gt; mean.<span class="dt">set</span> &lt;- colMeans(iris.<span class="dt">set</span>)
&gt; mean.versi &lt;- colMeans(iris.versi)
&gt; mean.virg &lt;- colMeans(iris.virg)
&gt; <span class="co"># combining the output (The combine step)</span>
&gt; mean.iris &lt;- rbind(mean.<span class="dt">set</span>,mean.versi,mean.virg)
&gt; <span class="co"># giving row names so that the output could be easily understood</span>
&gt; rownames(mean.iris) &lt;- c(<span class="st">&quot;setosa&quot;</span>,<span class="st">&quot;versicolor&quot;</span>,<span class="st">&quot;virginica&quot;</span>)
&gt; mean.iris</code></pre>
<pre class="output"><code>           Sepal.Length Sepal.Width Petal.Length Petal.Width
setosa            5.006       3.428        1.462       0.246
versicolor        5.936       2.770        4.260       1.326
virginica         6.588       2.974        5.552       2.026</code></pre>
<p><strong>split-apply-combine 루프 방법</strong></p>
<pre class="sourceCode python"><code class="sourceCode python">&gt; <span class="co"># split-apply-combine using loop</span>
&gt; <span class="co"># each iteration represents split </span>
&gt; <span class="co"># mean calculation within each iteration represents apply step</span>
&gt; <span class="co"># rbind command in each iteration represents combine step</span>
&gt; mean.iris.loop &lt;- NULL
&gt; <span class="kw">for</span>(species in unique(iris$Species))
+ {
+     iris_sub &lt;- iris[iris$Species==species,]
+     column_means &lt;- colMeans(iris_sub[,-<span class="dv">5</span>])
+     mean.iris.loop &lt;- rbind(mean.iris.loop,column_means)
+ } 
&gt; <span class="co"># giving row names so that the output could be easily understood</span>
&gt; rownames(mean.iris.loop) &lt;- unique(iris$Species)
&gt; mean.iris.loop</code></pre>
<p><strong>plyr 라이브러리</strong>를 사용해서 동일한 작업을 plyr 라이브러리를 활용하여 몇줄의 코드로 할 수 있다.</p>
<pre class="sourceCode python"><code class="sourceCode python">&gt; library (plyr)
&gt; ddply(iris,~Species,function(x) colMeans(x[,-which(colnames(x)==<span class="st">&quot;Species&quot;</span>)]))
     Species Sepal.Length Sepal.Width Petal.Length Petal.Width
<span class="dv">1</span>     setosa        <span class="fl">5.006</span>       <span class="fl">3.428</span>        <span class="fl">1.462</span>       <span class="fl">0.246</span>
<span class="dv">2</span> versicolor        <span class="fl">5.936</span>       <span class="fl">2.770</span>        <span class="fl">4.260</span>       <span class="fl">1.326</span>
<span class="dv">3</span>  virginica        <span class="fl">6.588</span>       <span class="fl">2.974</span>        <span class="fl">5.552</span>       <span class="fl">2.026</span></code></pre>
<h5 id="데이터-재정의-data-reshape">데이터 재정의 (Data Reshape)</h5>
<p>데이터를 재정의하여 원하는 자료 형식을 얻는 방식은 <code>reshape</code> 패키지를 이용하는 방법과 <code>sqldf</code>를 사용하는 방식이 있다. <code>sqldf</code>는 &quot;sql DSL(Domain Specific Language)&quot;를 재사용할 수 있다는 측면과 <code>sqlite</code>를 사용할 경우 기존 <code>R</code>명령어를 조합하는 것에 비하여 속도향상을 기대할 수 있다.</p>
<p><strong><code>Reshape</code> 패키지</strong></p>
<p>Hadley Wickham, &quot;Reshaping Data with the reshape Package&quot;, Journal of Statistical Software, November 2007, Volume 21, Issue 12. <a href="http://www.jstatsoft.org/v21/i12/paper" class="uri">http://www.jstatsoft.org/v21/i12/paper</a><br />통계분석자료는 행과 열로 구성되며, 행은 관측점을 열은 관측점의 정보를 담고있는 변수, 특징등으로 구성된다. 열정보 변수는 식별변수 (identifier variable)과 측정변수(measured variable)로 구성된다. 열정보 변수가 식별변수로 저장된 경우 프라이머리 키로 통상 불리우는 식별변수의 경우 범주형 정보로 나타나고, 측정변수의 경우는 관심있는 정보를 담게된다.자료를 관측값 중심으로 자료를 수학/국어/영어의 영역으로 나누어 저장할 경우 많은 열을 가진 테이블 형식으로 저장된다.</p>
<pre class="sourceCode python"><code class="sourceCode python">&gt; <span class="co"># Example of typical two dimensional data</span>
&gt; <span class="co"># A demo dataset &quot;students&quot; with typical layout. This data  </span>
&gt; <span class="co"># contains two students&#39; exam score of &quot;math&quot;, &quot;literature&quot;  </span>
&gt; <span class="co"># and &quot;language&quot; in different term exam.</span>
&gt; students &lt;- data.frame(sid=c(<span class="dv">1</span>,<span class="dv">2</span>),
+                        math<span class="fl">.1</span>=c(<span class="dv">50</span>,<span class="dv">65</span>),
+                        literature<span class="fl">.1</span>=c(<span class="dv">40</span>,<span class="dv">45</span>),
+                        language<span class="fl">.1</span>=c(<span class="dv">70</span>,<span class="dv">80</span>),
+                        math<span class="fl">.2</span>=c(<span class="dv">75</span>,<span class="dv">69</span>),
+                        literature<span class="fl">.2</span>=c(<span class="dv">55</span>,<span class="dv">59</span>),
+                        language<span class="fl">.2</span>=c(<span class="dv">75</span>,<span class="dv">78</span>))
&gt; students
  sid math<span class="fl">.1</span> literature<span class="fl">.1</span> language<span class="fl">.1</span> math<span class="fl">.2</span> literature<span class="fl">.2</span> language<span class="fl">.2</span>
<span class="dv">1</span>   <span class="dv">1</span>     <span class="dv">50</span>           <span class="dv">40</span>         <span class="dv">70</span>     <span class="dv">75</span>           <span class="dv">55</span>         <span class="dv">75</span>
<span class="dv">2</span>   <span class="dv">2</span>     <span class="dv">65</span>           <span class="dv">45</span>         <span class="dv">80</span>     <span class="dv">69</span>           <span class="dv">59</span>         <span class="dv">78</span>

&gt; students &lt;- data.frame(sid=c(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>),
+                        exmterm=c(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),
+                        math=c(<span class="dv">50</span>,<span class="dv">65</span>,<span class="dv">75</span>,<span class="dv">69</span>),
+                        literature=c(<span class="dv">40</span>,<span class="dv">45</span>,<span class="dv">55</span>,<span class="dv">59</span>),
+                        language=c(<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">75</span>,<span class="dv">78</span>))
&gt; students
  sid exmterm math literature language
<span class="dv">1</span>   <span class="dv">1</span>       <span class="dv">1</span>   <span class="dv">50</span>         <span class="dv">40</span>       <span class="dv">70</span>
<span class="dv">2</span>   <span class="dv">1</span>       <span class="dv">2</span>   <span class="dv">65</span>         <span class="dv">45</span>       <span class="dv">80</span>
<span class="dv">3</span>   <span class="dv">2</span>       <span class="dv">1</span>   <span class="dv">75</span>         <span class="dv">55</span>       <span class="dv">75</span>
<span class="dv">4</span>   <span class="dv">2</span>       <span class="dv">2</span>   <span class="dv">69</span>         <span class="dv">59</span>       <span class="dv">78</span>
&gt; molten_students &lt;- melt.data.frame(students,<span class="dt">id</span>.<span class="dt">vars</span>=c(<span class="st">&quot;sid&quot;</span>,<span class="st">&quot;exmterm&quot;</span>))
&gt; molten_students
   sid exmterm   variable value
<span class="dv">1</span>    <span class="dv">1</span>       <span class="dv">1</span>       math    <span class="dv">50</span>
<span class="dv">2</span>    <span class="dv">1</span>       <span class="dv">2</span>       math    <span class="dv">65</span>
<span class="dv">3</span>    <span class="dv">2</span>       <span class="dv">1</span>       math    <span class="dv">75</span>
<span class="dv">4</span>    <span class="dv">2</span>       <span class="dv">2</span>       math    <span class="dv">69</span>
<span class="dv">5</span>    <span class="dv">1</span>       <span class="dv">1</span> literature    <span class="dv">40</span>
<span class="dv">6</span>    <span class="dv">1</span>       <span class="dv">2</span> literature    <span class="dv">45</span>
<span class="dv">7</span>    <span class="dv">2</span>       <span class="dv">1</span> literature    <span class="dv">55</span>
<span class="dv">8</span>    <span class="dv">2</span>       <span class="dv">2</span> literature    <span class="dv">59</span>
<span class="dv">9</span>    <span class="dv">1</span>       <span class="dv">1</span>   language    <span class="dv">70</span>
<span class="dv">10</span>   <span class="dv">1</span>       <span class="dv">2</span>   language    <span class="dv">80</span>
<span class="dv">11</span>   <span class="dv">2</span>       <span class="dv">1</span>   language    <span class="dv">75</span>
<span class="dv">12</span>   <span class="dv">2</span>       <span class="dv">2</span>   language    <span class="dv">78</span></code></pre>
<p><strong>sqldf 패키지</strong></p>
<p><code>sqldf</code>를 사용할 경우 database를 신규로 생성할 필요가 없으며, 데이터베이스로부터 import export가 불필요하며 특정열을 다루는데 있어서 편리한 점이 있다.</p>
<pre class="sourceCode python"><code class="sourceCode python">&gt; library(sqldf)
&gt; subiris&lt;- sqldf(<span class="st">&quot;select * from iris where Sepal_Width&gt; 3&quot;</span>)
&gt; head(subiris)
  Sepal_Length Sepal_Width Petal_Length Petal_Width Species
<span class="dv">1</span>          <span class="fl">5.1</span>         <span class="fl">3.5</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>  setosa
<span class="dv">2</span>          <span class="fl">4.7</span>         <span class="fl">3.2</span>          <span class="fl">1.3</span>         <span class="fl">0.2</span>  setosa
<span class="dv">3</span>          <span class="fl">4.6</span>         <span class="fl">3.1</span>          <span class="fl">1.5</span>         <span class="fl">0.2</span>  setosa
<span class="dv">4</span>          <span class="fl">5.0</span>         <span class="fl">3.6</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>  setosa
<span class="dv">5</span>          <span class="fl">5.4</span>         <span class="fl">3.9</span>          <span class="fl">1.7</span>         <span class="fl">0.4</span>  setosa
<span class="dv">6</span>          <span class="fl">4.6</span>         <span class="fl">3.4</span>          <span class="fl">1.4</span>         <span class="fl">0.3</span>  setosa
&gt; subiris2&lt;-
+ sqldf(<span class="st">&quot;select Sepal_Length,Petal_Length,Species from iris where Petal_length&gt; 1.4&quot;</span>)
&gt; nrow(subiris2)
[<span class="dv">1</span>] <span class="dv">126</span>
&gt; head(subiris2)
  Sepal_Length Petal_Length Species
<span class="dv">1</span>          <span class="fl">4.6</span>          <span class="fl">1.5</span>  setosa
<span class="dv">2</span>          <span class="fl">5.4</span>          <span class="fl">1.7</span>  setosa
<span class="dv">3</span>          <span class="fl">5.0</span>          <span class="fl">1.5</span>  setosa
<span class="dv">4</span>          <span class="fl">4.9</span>          <span class="fl">1.5</span>  setosa
<span class="dv">5</span>          <span class="fl">5.4</span>          <span class="fl">1.5</span>  setosa
<span class="dv">6</span>          <span class="fl">4.8</span>          <span class="fl">1.6</span>  setosa</code></pre>
        </div>
      </div>
      <div class="footer">
        <a class="label swc-blue-bg" href="http://software-carpentry.org">Software Carpentry</a>
        <a class="label swc-blue-bg" href="https://github.com/swcarpentry/lesson-template">Source</a>
        <a class="label swc-blue-bg" href="mailto:admin@software-carpentry.org">Contact</a>
        <a class="label swc-blue-bg" href="LICENSE.html">License</a>
      </div>
    </div>
    <!-- Javascript placed at the end of the document so the pages load faster -->
    <script src="http://software-carpentry.org/v5/js/jquery-1.9.1.min.js"></script>
    <script src="css/bootstrap/bootstrap-js/bootstrap.js"></script>
  </body>
</html>
